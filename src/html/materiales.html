<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Materiales - Panel de Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="../storage/vectors/browser-svgrepo-com.svg" alt="Logo" class="logo-icon">
                    <span class="logo-text">Panel de Control</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">
                            <img src="../storage/vectors/home-svgrepo-com.svg" alt="Inicio" class="nav-icon">
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="empleados.html" class="nav-link">
                            <img src="../storage/vectors/user-svgrepo-com.svg" alt="Empleados" class="nav-icon">
                            <span class="nav-text">Empleados</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="materiales.html" class="nav-link">
                            <img src="../storage/vectors/layers-svgrepo-com.svg" alt="Materiales" class="nav-icon">
                            <span class="nav-text">Materiales</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="otros-gastos.html" class="nav-link">
                            <img src="../storage/vectors/briefcase-svgrepo-com.svg" alt="Otros Gastos" class="nav-icon">
                            <span class="nav-text">Otros Gastos</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="tareas.html" class="nav-link">
                            <img src="../storage/vectors/clipboard-svgrepo-com.svg" alt="Tareas" class="nav-icon">
                            <span class="nav-text">Tareas</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button onclick="abrirModalConfiguracion()" class="nav-link settings-link">
                    <img src="../storage/vectors/settings-svgrepo-com.svg" alt="Configuraci√≥n" class="nav-icon">
                    <span class="nav-text">Configuraci√≥n</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <h1 class="page-title">Gesti√≥n de Materiales</h1>
                    <p class="page-subtitle">Administra el inventario y costos de materiales del proyecto</p>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <img src="../storage/vectors/portrait-user-svgrepo-com.svg" alt="Usuario" class="user-avatar">
                        <span class="user-name">Administrador</span>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="dashboard-content">
                <!-- Action Buttons -->
                <div class="action-buttons-section">
                    <div class="buttons-section">
                        <button onclick="crearMaterialPersonalizado()" class="button button-success">
                            <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="button-icon">
                            Crear Material Nuevo
                        </button>
                        
                        <button onclick="limpiarListaMateriales()" class="button button-warning">
                            <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="button-icon">
                            Limpiar Lista
                        </button>
                    </div>
                </div>

                <!-- Stats Section -->
                <div class="stats-section">
                    <h2 class="section-title">Estad√≠sticas de Materiales</h2>
                    <div id="estadisticasMateriales" class="stats-grid">
                        <!-- Estad√≠sticas se llenar√°n aqu√≠ -->
                    </div>
                </div>

                <!-- Materials List -->
                <div class="employees-section">
                    <div class="section-header-employees">
                        <h2 class="section-title">
                            <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="layers-icon-large">
                            Lista de Materiales (<span id="contadorMateriales">0</span>)
                        </h2>
                    </div>
                    
                    <div id="listaMateriales" class="employees-list">
                        <!-- Lista de materiales se llenar√° aqu√≠ -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Crear Material -->
    <div id="modalCrearMaterial" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="modal-title-icon">
                    Crear Nuevo Material
                </h2>
                <button onclick="cerrarModalCrearMaterial()" class="modal-close">√ó</button>
            </div>
            
            <div class="modal-body">
                <div class="config-panel">
                    <h3>
                        <img src="../storage/vectors/portrait-user-svgrepo-com.svg" alt="" class="portrait-user-icon-large">
                        Informaci√≥n del Material
                    </h3>
                    <p>Complete todos los campos para crear el material:</p>
                    
                    <div class="config-grid">
                        <div class="input-group">
                            <label for="nombreMaterial">
                                <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="input-icon">
                                Nombre del Material:
                            </label>
                            <input type="text" id="nombreMaterial" placeholder="Ej: Cemento Portland">
                            <small id="errorNombreMaterial" class="error-message"></small>
                        </div>
                        
                        <div class="input-group">
                            <label for="costoPorUnidad">
                                <img src="../storage/vectors/cash-register-svgrepo-com.svg" alt="" class="input-icon">
                                Costo por Unidad ($):
                            </label>
                            <input type="number" id="costoPorUnidad" step="0.01" min="0" placeholder="Ej: 15.75">
                            <small id="errorCostoPorUnidad" class="error-message"></small>
                        </div>
                    </div>
                    
                    <div class="info-note">
                        <strong>
                            <img src="../storage/vectors/traffic-light-svgrepo-com.svg" alt="" class="info-icon">
                            Informaci√≥n:
                        </strong><br>
                        ‚Ä¢ <strong>Inventario inicial:</strong> Comenzar√° autom√°ticamente en 0 unidades<br>
                        ‚Ä¢ <strong>Validaci√≥n:</strong> El costo debe estar dentro del rango configurado<br>
                        ‚Ä¢ <strong>Caracteres prohibidos:</strong> No se permiten caracteres especiales en el nombre<br>
                        ‚Ä¢ <strong>Rango actual:</strong> <span id="rangoInfoMaterial">Cargando...</span>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button onclick="validarYCrearMaterial()" class="button button-success">
                    <img src="../storage/vectors/circle-check-svgrepo-com.svg" alt="" class="button-icon">
                    Crear Material
                </button>
                <button onclick="limpiarFormularioMaterial()" class="button button-info">
                    <img src="../storage/vectors/refresh-ccw-clock-svgrepo-com.svg" alt="" class="button-icon">
                    Limpiar Campos
                </button>
                <button onclick="cerrarModalCrearMaterial()" class="button button-danger">
                    <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="button-icon">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Gestionar Inventario -->
    <div id="modalGestionarInventario" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="../storage/vectors/briefcase-svgrepo-com.svg" alt="" class="modal-title-icon">
                    Gestionar Inventario
                </h2>
                <button onclick="cerrarModalGestionarInventario()" class="modal-close">√ó</button>
            </div>
            
            <div class="modal-body">
                <div class="config-panel">
                    <h3>
                        <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="config-icon">
                        Informaci√≥n del Material
                    </h3>
                    <div id="infoMaterialInventario" class="material-info">
                        <!-- Informaci√≥n del material se llenar√° aqu√≠ -->
                    </div>
                    
                    <div class="config-grid">
                        <div class="input-group">
                            <label for="cantidadInventario">
                                <img src="../storage/vectors/calculator-svgrepo-com.svg" alt="" class="input-icon">
                                Cantidad:
                            </label>
                            <input type="number" id="cantidadInventario" step="0.01" min="0" placeholder="Ej: 10">
                            <small id="errorCantidadInventario" class="error-message"></small>
                        </div>
                        
                        <div class="input-group">
                            <label for="accionInventario">
                                <img src="../storage/vectors/briefcase-svgrepo-com.svg" alt="" class="input-icon">
                                Acci√≥n:
                            </label>
                            <select id="accionInventario" class="form-select">
                                <option value="agregar">Agregar al inventario</option>
                                <option value="quitar">Quitar del inventario</option>
                            </select>
                            <small id="errorAccionInventario" class="error-message"></small>
                        </div>
                    </div>
                    
                    <div class="info-note">
                        <strong>
                            <img src="../storage/vectors/traffic-light-svgrepo-com.svg" alt="" class="info-icon">
                            Instrucciones:
                        </strong><br>
                        ‚Ä¢ <strong>Cantidad:</strong> Ingrese solo n√∫meros positivos (ej: 10)<br>
                        ‚Ä¢ <strong>Acci√≥n:</strong> Seleccione "Agregar" o "Quitar" del inventario<br>
                        ‚Ä¢ <strong>Validaci√≥n:</strong> No se puede quitar m√°s inventario del disponible<br>
                        ‚Ä¢ <strong>Seguridad:</strong> El inventario nunca ser√° menor a 0
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button onclick="aplicarCambioInventario()" class="button button-success">
                    <img src="../storage/vectors/circle-check-svgrepo-com.svg" alt="" class="button-icon">
                    Aplicar Cambio
                </button>
                <button onclick="limpiarFormularioInventario()" class="button button-info">
                    <img src="../storage/vectors/refresh-ccw-clock-svgrepo-com.svg" alt="" class="button-icon">
                    Limpiar Campo
                </button>
                <button onclick="cerrarModalGestionarInventario()" class="button button-danger">
                    <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="button-icon">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Advertencia para Material en Tareas Activas -->
    <div id="modalAdvertenciaMaterialEnTareas" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="../storage/vectors/alarm-exclamation-svgrepo-com.svg" alt="" class="modal-title-icon">
                    No se puede eliminar
                </h2>
                <button onclick="cerrarModalAdvertenciaMaterialEnTareas()" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="confirmacion-mensaje">
                    <img src="../storage/vectors/alarm-exclamation-svgrepo-com.svg" alt="" class="confirmacion-icon">
                    <p id="mensajeAdvertenciaMaterialEnTareas">Este material no se puede eliminar porque est√° asignado a tareas activas.</p>
                </div>
            </div>
            <div class="modal-footer">
                <div class="buttons-section">
                    <button onclick="cerrarModalAdvertenciaMaterialEnTareas()" class="button button-info">
                        <img src="../storage/vectors/ban-svgrepo-com.svg" alt="" class="button-icon">
                        Entendido
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmaci√≥n para Eliminar Material -->
    <div id="modalConfirmacionEliminarMaterial" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="modal-title-icon">
                    Confirmar Eliminaci√≥n
                </h2>
                <button onclick="cerrarModalConfirmacionEliminarMaterial()" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="confirmacion-mensaje">
                    <img src="../storage/vectors/alarm-exclamation-svgrepo-com.svg" alt="" class="confirmacion-icon">
                    <p id="mensajeConfirmacionEliminarMaterial">¬øEst√° seguro de que desea eliminar este material?</p>
                </div>
            </div>
            <div class="modal-footer">
                <div class="buttons-section">
                    <button onclick="confirmarEliminacionMaterial()" class="button button-danger">
                        <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="button-icon">
                        S√≠, Eliminar
                    </button>
                    <button onclick="cerrarModalConfirmacionEliminarMaterial()" class="button button-info">
                        <img src="../storage/vectors/ban-svgrepo-com.svg" alt="" class="button-icon">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Configuraci√≥n -->
    <div id="modalConfiguracion" class="modal">
        <div class="modal-content config-modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="../storage/vectors/settings-svgrepo-com.svg" alt="" class="modal-title-icon">
                    Configuraci√≥n Global del Sistema
                </h2>
                <button onclick="cerrarModalConfiguracion()" class="modal-close">√ó</button>
            </div>
            
            <div class="modal-body config-content">
                <div class="config-panel">
                    <h2>
                        <img src="../storage/vectors/layers-svgrepo-com.svg" alt="" class="config-icon">
                        Configuraci√≥n de Rangos para Materiales
                    </h2>
                    <p>Define los rangos espec√≠ficos para costos de materiales:</p>
                    
                    <div class="config-grid">
                        <div class="input-group">
                            <label for="costoPorUnidadMin">
                                <img src="../storage/vectors/cash-register-svgrepo-com.svg" alt="" class="input-icon">
                                Costo por Unidad - M√≠nimo ($):
                            </label>
                            <input type="number" id="costoPorUnidadMin" value="1" step="0.01">
                        </div>
                        
                        <div class="input-group">
                            <label for="costoPorUnidadMax">
                                <img src="../storage/vectors/cash-register-svgrepo-com.svg" alt="" class="input-icon">
                                Costo por Unidad - M√°ximo ($):
                            </label>
                            <input type="number" id="costoPorUnidadMax" value="1000" step="0.01">
                        </div>
                    </div>
                    
                    <div class="info-note">
                        <strong>
                            <img src="../storage/vectors/traffic-light-svgrepo-com.svg" alt="" class="info-icon">
                            Nota:
                        </strong> Estos rangos se aplicar√°n espec√≠ficamente a materiales:<br>
                        <strong>üì¶ Costo por Unidad:</strong> Validaci√≥n para precios de materiales<br>
                        <strong>Inventario:</strong> Los materiales pueden tener inventario gestionable<br>
                        <strong>‚ö° Aplicaci√≥n:</strong> Los cambios se aplicar√°n inmediatamente en la creaci√≥n de materiales
                    </div>
                    
                    <div class="range-display-container">
                        <div id="rangosActuales" class="range-display">
                            <strong>Rangos configurados:</strong><br>
                            Materiales: $1.00 - $1000.00
                        </div>
                    </div>
                    
                    <button onclick="aplicarConfiguracionRangosMateriales()" class="button button-success">
                        <img src="../storage/vectors/save-svgrepo-com.svg" alt="" class="button-icon">
                        Aplicar Configuraci√≥n de Materiales
                    </button>
                </div>

                <div class="config-panel">
                    <h2>
                        <img src="../storage/vectors/shield-svgrepo-com.svg" alt="" class="config-icon">
                        Configuraci√≥n de Validaci√≥n
                    </h2>
                    
                    <div class="config-grid">
                        <div class="input-group">
                            <label for="validacionEstricta">
                                <img src="../storage/vectors/lock-svgrepo-com.svg" alt="" class="input-icon">
                                Validaci√≥n Estricta de Nombres:
                            </label>
                            <select id="validacionEstricta">
                                <option value="true">Activada (Recomendado)</option>
                                <option value="false">Desactivada</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label for="mostrarConsejos">
                                <img src="../storage/vectors/lightbulb-svgrepo-com.svg" alt="" class="input-icon">
                                Mostrar Consejos de Ayuda:
                            </label>
                            <select id="mostrarConsejos">
                                <option value="true">S√≠ (Recomendado)</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="caracteresProhibidosPersonalizado">
                            <img src="../storage/vectors/traffic-light-svgrepo-com.svg" alt="" class="input-icon">
                            Caracteres Prohibidos Personalizados:
                        </label>
                        <input type="text" id="caracteresProhibidosPersonalizado" 
                               value="!&quot;¬∑$%&amp;/()=?¬ø'¬°+`*]^[¬¥.:,;-_{}&lt;&gt;`~\|" 
                               placeholder="Caracteres no permitidos en nombres">
                        <small>Modifica los caracteres que no se permiten en los nombres</small>
                    </div>
                    
                    <button onclick="aplicarConfiguracionValidacion()" class="button button-info">
                        <img src="../storage/vectors/save-svgrepo-com.svg" alt="" class="button-icon">
                        Aplicar Configuraci√≥n de Validaci√≥n
                    </button>
                </div>

                <div class="config-panel">
                    <h2>
                        <img src="../storage/vectors/database-svgrepo-com.svg" alt="" class="config-icon">
                        Configuraci√≥n de Datos
                    </h2>
                    
                    <div class="buttons-section">
                        <button onclick="exportarConfiguracion()" class="button button-success">
                            <img src="../storage/vectors/download-svgrepo-com.svg" alt="" class="button-icon">
                            Exportar Configuraci√≥n
                        </button>
                        
                        <button onclick="resetearConfiguracion()" class="button button-warning">
                            <img src="../storage/vectors/refresh-svgrepo-com.svg" alt="" class="button-icon">
                            Restaurar Por Defecto
                        </button>
                        
                        <button onclick="limpiarDatosSistema()" class="button button-danger">
                            <img src="../storage/vectors/trash-svgrepo-com.svg" alt="" class="button-icon">
                            Limpiar Todos los Datos
                        </button>
                    </div>
                </div>

                <div class="config-panel">
                    <h2>
                        <img src="../storage/vectors/stats-svgrepo-com.svg" alt="" class="config-icon">
                        Estad√≠sticas del Sistema
                    </h2>
                    <div id="estadisticasSistema" class="stats-panel">
                        <!-- Estad√≠sticas se llenar√°n aqu√≠ -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../js/Personal.js"></script>
    <script src="../js/Material.js"></script>
    <script src="../js/OtrosCostos.js"></script>
    <script src="../js/materiales.js"></script>
</body>
</html>